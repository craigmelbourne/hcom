<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>Android: SRP - PDP</title>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/jquery-ui.min.js"></script>
		<script src="../hcom-services.js"></script>

		<link rel="stylesheet" type="text/css" href="srp-pdp.css">

		<style type="text/css">

		
		</style>

	</head>
	<body>

		<div id="header" class="shadow-bottom"></div>

		<div style="overflow:hidden;">
			<div id="list-wrapper" style="">
				<div id="hotel-list"></div>
			</div>

			<div id="details-wrapper">
				<div id="details">
					<div style="height:212px; background-color:#E84C3D;">
						<div id="close-pdp" style="padding:12px;">
							<img src="../i/back.png" />
						</div>
						<div id="hotel-wrapper">
							
							<div class="content-head">
								<div style="width:60%; float:left; box-sizing:border-box;">
									<h1></h1>
									<div class="stars">&#9733;&#9733;&#9733;&#9733;</div>
								</div>
								<div id="price">
									<div >
										<span class="strike-through"></span> 
										<span class="total"></span>
									</div>
									<span class="fees">price for 1 night including taxes and fees</span><br />
									<button class="book-large">BOOK NOW</button>
								</div>
								<div style="height:400px"></div>
								<div class="review-summary">
									<div class="score">
										<span class="hcom-score" style="font-size:16px; line-height:24px; font-weight:bold;"></span> <br />
										<span class="hcom-num-reviews" style="font-size:13px;">230 Hotels.com reviews</span>
									</div>
									<div class="score">
										<img src="../i/trip45.png" /> <br />
										<span style="font-size:13px;">230 Trip Advisor reviews</span>
									</div>
								</div>
								<div id="about" style="padding:0 24px;">
									<h2>About this hotel</h2>
									<div class="description"></div>

									<div style="">
										<ul class="amenities">
        									<li>Air conditioned</li>
        									<li>Airport shuttle</li>
        									<li>Concierge</li>
        									<li>English Speaking</li>
        									<li>Fitness Center</li>
        									<li>Swimming pool</li>
     									 </ul>
									</div>
									<div class="all">
										<a href="#" id="about">All amenities</a>
									</div>
								</div>
							</div>

							

							<div id="room" class="content-block" >
								<h2>Lowest price room</h2>
								<div class="all">
									<a href="#" id="about">All rooms</a>
								</div>
							</div>
							<div id="reviews" class="content-block" >
								<h2>Guest reviews</h2>
								<div style="overflow:hidden;">
		<div class="score" style="float:left; width:50%; box-sizing:border-box;">

			
				<div style="font-size:18px; margin-bottom:12px;">4.5 / 5  Excellent (193 reviews)</div>

				<div style="margin-bottom:6px;">Score breakdown</div>
			
			<div style="overflow:hidden;">
				<div style="">
					<ul style="font-size:14px; margin:0; padding:0; list-style-type:none;">
						<li>
							<div style="background-color:#eee; width:82%; border-bottom:solid 5px #fff;"><span style="background-color:#fff;">5.0 &nbsp;</span>
							</div>
						</li>
						<li>
							<div style="background-color:#eee; width:63%; border-bottom:solid 5px #fff;"><span style="background-color:#fff; border-bottom:solid 2px #fff;">4.0 &nbsp;</span>
							</div>
						</li>
						<li><div style="background-color:#eee; width:42%; border-bottom:solid 5px #fff;"><span style="background-color:#fff; border-bottom:solid 2px #fff;">3.0 &nbsp;</span>
							</div></li>
							<li><div style="background-color:#eee; width:22%; border-bottom:solid 5px #fff;"><span style="background-color:#fff; border-bottom:solid 2px #fff;">2.0 &nbsp;</span>
							</div></li>
							<li><div style="background-color:#eee; width:22%; border-bottom:solid 5px #fff;"><span style="background-color:#fff; border-bottom:solid 2px #fff;">1.0 &nbsp;</span>
							</div></li>
						
					</ul>
				</div>

			</div>

			
		</div>
		<div class="review" style="font-size:16px; line-height:18px; float:left; width:50%; box-sizing:border-box;">
			<p style="margin-top:0; font-style:italic">"Beautiful but small rooms. Decorated to very high standard. Great shower! Loved the pantry at the end of the corridor!"</p>
			<p style="font-style:italic">"Even though the room was small, it was so well designed that it didn't really matter."" </p>
		</div>
		</div>
								<div class="all">
									<a href="#" id="about">All reviews</a>
								</div>
							</div>

							<div id="location" class="content-block" >
								<h2>Location</h2>

								<div style="overflow:hidden; margin-top:12px;">
									<div id="map-placeholder" style="width:50%; float:left; box-sizing:border-box; height:250px; background-color:#eee; position:relative;">
										<div id="map-wrapper">
  											<div id="map_canvas" style="width:100%; height:100%;"></div>
  											<div id="map-close" style="position:absolute; top:24px; left:24px; padding:12px; display:none; background-color:#fff;">X | Close map</div>
										</div>
									</div>
									<div style="width:50%; float:left; box-sizing:border-box; padding-left:24px;">
										<p class="address"></p>
										<div style="margin:6px 0 18px;font-size:13px;">0203 027 9779</div>
										<span style="font-size:14px; font-weight:bold;">What's around</span>	
										<ul class="landmarks" style=""></ul>
									</div>
								</div>

								<div class="all">
									<a href="#" id="about">Open map full screen</a>
								</div>
							</div>
						</div>

						
						
					</div>
					
					<div id="slideshow">
						<div class="wrapper">
						</div>
					</div>

				</div>
			</div>
			
		</div>

		

		
		<script>

			$(function(){
				

				fetchHotelList('London', displayHotelList);
				//var hotels = fetchSearchResults("London");
				//console.log(hotels);

				$("#hotel-list").on("click", "div.hotel", function(){
					fetchHotelDetails($(this).attr("id"), displayHotelDetails);
					$("#details h1").text($(this).find(".name").text());
					$("#price .total").text($(this).find(".total").text());
					$(".hcom-score").text($(this).find(".qual").text());
					$(".hcom-num-reviews").text($(this).find(".num-reviews").text() + " Hotels.com reviews");
					$("#details-wrapper").show("slide", { direction: "right" }, 500);
				});

				$("#close-pdp").on("click", function(){
					$("#details-wrapper").hide("slide", { direction: "right" }, 500, function(){
						$("#slideshow .wrapper").empty();
						$("ul.landmarks").empty();
					});
				})

			});

			var displayHotelList = function(data, textStatus, xhr)
			{
				var hotels = data.result.hotels;
				console.log(hotels);
				$.each( hotels, function( i, hotel ) {
  					//console.log( i + ": " + hotel.hotelName );

					$("#hotel-list").append(
						'<div class="hotel" id="'+ hotel.hotelId + '">' 
						+ '<h2 class="name">' + hotel.hotelName + '</h2>'
						+ '<div class="total">' + hotel.promoPrice + '</div>'
						+ '<div class="qual">' + hotel.qualitativeBadgeText + " " + hotel.guestReviewRating.toFixed(1) + '/5 </div>'
						+ '<span class="num-reviews" style="visibility:hidden;">' + hotel.numberOfGuestReviews + '</span>'
						+ '</div>'
					)
				});
			}

			var displayHotelDetails = function(data, textStatus, xhr){
				console.log(data.result);

				var photos = data.result.photos
				var summary = data.result.roomRates.hotelSummary
				var landmarks = data.result.map.shortDistanceGroup.groupDestinations;
				//console.log(landmarks)

				var d = data.result.description.overview
				var s = d.indexOf("<p>") + 3;
				var e = d.indexOf("</p>");
				//console.log (s + " " + e);

				var des = d.substring(s, e);
				//console.log(des)

				//summary.reviewsTotalCount

				// slide show
				$.each( photos, function( i, photo ) {
					$("#slideshow .wrapper").append(
						'<div class="internal"><img src="' + photo.url  + '" /></div>'
					);
				});

				for (i = 0; i < 5; i++) { 
    				$("ul.landmarks").append('<li>' + landmarks[i] + '</li>');
    				console.log(landmarks[i])
				}

				$("#about .description").html(des);
				$("#location .address").text(summary.address1 + ", " + summary.locality + ", " + summary.countryName + ", " + summary.postalCode);


			}

			


			


		</script>
	</body>
</html>