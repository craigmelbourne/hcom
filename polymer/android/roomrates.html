<!doctype html>
<html>

<head>

	<script src="../jquery.js"></script>
	
	<script type="text/javascript">

		var rooms;

		$(function(){
			getRooms("172847");
		});

		function getRooms(hotelId){


			$.ajax({

			crossDomain: true,
        	url: "https://api.eancdn.com/ean-services/rs/hotel/v3/avail",

			data: {
            	cid: 55505,
            	minorRev: 99,
            	apiKey: "xgdsee58vcvfhpr4hhvvhych",
            	locale: "en_US",
            	currencyCode: "GBP",
            	arrivalDate: "09/30/2014",
            	departureDate: "10/01/2014",
            	hotelId: hotelId,
            	room1: 2
        	},

        	// whether this is a POST or GET request
        	type: "GET",

        	// the type of data we expect back
        	dataType : "jsonp",
        	timeout:3000,
 
        	// code to run if the request succeeds;
        	// the response is passed to the function
        	success: function( json ) {
        		console.log (json.HotelRoomAvailabilityResponse);
        		rooms = json.HotelRoomAvailabilityResponse.HotelRoomResponse

        		$("body").append(
        			"Best rate - " + rooms[0].roomTypeDescription
        		);


        		$.each(rooms, function(i, room) {

        			$("body").append(
        				"<div class='rate'>"
        				+ room.roomTypeDescription + " - " 
        				+ room.quotedOccupancy + " - "
        				+ room.RateInfos.RateInfo.ChargeableRateInfo["@total"]
        				+ "</div>"
        			);


						console.log(room.RateInfos.RateInfo.ChargeableRateInfo["@total"]);

		
				});

        		//var hotels = json.HotelListResponse.HotelList.HotelSummary;
        		//callback(hotels);
        	
        	}, 

        	error: function( xhr, status, errorThrown ) {
            	 //alert( "Sorry, there was a problem!" );
            	console.log( "Error: " + errorThrown );
            	console.log( "Status: " + status );
            	console.dir( xhr );
        	},
 
        	// code to run regardless of success or failure
        	complete: function( xhr, status ) {
            
        	}

		});

		}

	</script>

</head>

<body>

</body>

</html>